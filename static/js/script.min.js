function openTab(e,t){var n,s,a;for(s=document.getElementsByClassName("content"),n=0;n<s.length;n++)s[n].style.display="none";for(a=document.getElementsByClassName("tab-item"),n=0;n<a.length;n++)a[n].className=a[n].className.replace(" active","");document.getElementById(t).style.display="block",e.currentTarget.className+=" active"}function updateChannels(e){for(var t=0;t<=47;t++)$("#cval-"+(t+1)).text()!=e.channels[t]?$("#cval-"+(t+1)).addClass("green-text").removeClass("red-text"):($("#cval-"+(t+1)).hasClass("green-text")&&$("#cval-"+(t+1)).removeClass("green-text"),$("#cval-"+(t+1)).addClass("red-text")),$("#cval-"+(t+1)).text(e.channels[t]);return 0}function updateCues(e){if($("#cues").empty(),$("#cues-display").empty(),0!=e.cues.length){null!=e.current_cue?(0!=e.current_cue&&$("#cues-display").append('<div class="cue-item no-hover"><h4>Previous: '+e.cues[e.current_cue-1].name+"</h4>"+e.cues[e.current_cue-1].description+"</div>"),$("#cues-display").append('<div class="cue-item no-hover background-green"><h4>Current: '+e.cues[e.current_cue].name+"</h4>"+e.cues[e.current_cue].description+"</div>"),e.current_cue!=e.cues.length-1&&e.cues.length>1&&$("#cues-display").append('<div class="cue-item no-hover"><h4>Next: '+e.cues[e.current_cue+1].name+"</h4>"+e.cues[e.current_cue+1].description+"</div>")):$("#cues-display").append('<div class="cue-item no-hover"><h4>Next: '+e.cues[0].name+"</h4>"+e.cues[0].description+"</div>");for(var t=0;t<e.cues.length;t++)$("#cues").append('<div class="cue-item" cueVal="'+t+'"><h4>'+e.cues[t].name+"</h4>"+e.cues[t].description+"</div>"),null!=e.selected_cue&&e.selected_cue==t&&$("div[cueVal="+t+"]").addClass("background-green")}return null==e.selected_cue&&($("#cueName").val(""),$("#cueDescription").val(""),$("#cueTime").val(""),$("#cueFollow").val("")),0!=e.cues.length?$(".hidden-item").hasClass("hidden")&&$(".hidden-item").removeClass("hidden"):$(".hidden-item").addClass("hidden"),0}function updateSubs(e){if($("#Submasters").empty(),0!=e.submasters.length)for(var t=0;t<e.submasters.length;t++)$("#Submasters").append('<div class="col-1 submaster"><div class="sliders"><div class="slider" id="sub-'+t+'"></div></div><div class="subtitle"><button id="sub-btn-'+t+'" class="btn btn-yellow sub-btn">'+e.submasters[t].name+"</button></div></div>");for(var n=$(".slider"),s=0;s<n.length;s++)noUiSlider.create(n[s],{start:e.submasters[s].value,connect:[!0,!1],direction:"rtl",orientation:"vertical",range:{min:0,max:100},format:wNumb({decimals:0})}),n[s].noUiSlider.on("slide",function(){socket.emit("update sub val",{sub:this.target.getAttribute("id"),value:this.get()})});$(".sub-btn").succinct({size:12}),$("#Submasters").append('<div class="col-2 submaster"><button class="btn btn-green" id="addSubBtn"><i class="fas fa-plus-square"></i> New Submaster</button></div>')}function settingsDropdown(){document.getElementById("settingsDropdown").classList.toggle("show")}var socket=io.connect("http://"+document.domain+":"+location.port+"/tonalite");$(document).ready(function(){document.getElementById("keyboardTabBtn").click();for(var e=0;e<=47;e++)$("#Channels").append('<div class="col-1 channel"><div class="channel-item"><h2>'+(e+1)+'</h2><h1 id="cval-'+(e+1)+'">0</h1></div></div>');var t=document.getElementById("subSettingsModal"),n=document.getElementsByClassName("sub-modal-close")[0];n.onclick=function(){t.style.display="none"};var s=document.getElementById("usersModal"),a=document.getElementsByClassName("user-modal-close")[0];a.onclick=function(){s.style.display="none"},socket.on("update chans",function(e){updateChannels(e)}),socket.on("update chans and subs",function(e){updateChannels(e),updateSubs(e)}),socket.on("update subs",function(e){updateSubs(e)}),socket.on("update cues",function(e){updateCues(e)}),socket.on("cue settings",function(e){updateCues(e),$("#cueName").val(e.name),$("#cueDescription").val(e.description),$("#cueTime").val(e.time),$("#cueFollow").val(e.follow)}),socket.on("sub settings",function(e){if($("#subName").val(e.name),$("#subValue").val(e.value),$("#sub-channels").empty(),0!=e.channels.length)for(var n=0;n<e.channels.length;n++)$("#sub-channels").append('<div class="col-5"><input type="number" placeholder="Channel:" value="'+e.channels[n].channel+'" id="sub-channel-'+n+'-channel" min="1" max="48"></div><div class="col-5"><input type="number" placeholder="Value:" value="'+e.channels[n].value+'" id="sub-channel-'+n+'-value" min="0" max="255"></div><div class="col-1"><button class="btn btn-green btn-full btn-tall sub-chan-save" subChan="'+n+'"><i class="fas fa-save"></i></button></div><div class="col-1"><button class="btn btn-red btn-full btn-tall sub-chan-delete" subChan="'+n+'"><i class="fas fa-trash-alt"></i></button></div>');t.style.display="block"}),socket.on("update all",function(e){if(updateChannels(e),updateCues(e),updateSubs(e),""!=e.show.name&&($("#showName").val(e.show.name),$("#showDescription").val(e.show.description),$("#showAuthor").val(e.show.author),$("#showCopyright").val(e.show.copyright)),$("#serverIP").val(e.tonaliteSettings.serverIP),$("#serverPort").val(e.tonaliteSettings.serverPort),$("#sacnIP").val(e.tonaliteSettings.sacnIP),$("#users").empty(),0!=e.tonaliteSettings.users.length)for(var t=0;t<e.tonaliteSettings.users.length;t++)$("#users").append('<div class="col-11"><input type="text" placeholder="User:" value="'+e.tonaliteSettings.users[t][0]+'" ></div><div class="col-1"><button class="btn btn-red btn-full btn-tall user-delete" user="'+t+'"><i class="fas fa-trash-alt"></i></button></div>')}),socket.on("update chans and cues",function(e){updateChannels(e),updateCues(e)}),socket.on("update settings",function(e){$("#serverIP").val(e.tonaliteSettings.serverIP),$("#serverPort").val(e.tonaliteSettings.serverPort),$("#sacnIP").val(e.tonaliteSettings.sacnIP)}),socket.on("redirect",function(e){window.location="http://"+document.domain+":"+location.port+e.url}),$(".kbtn").click(function(){$("#commandInput").val($("#commandInput").val()+$(this).attr("inputVal"))}),$("#updateCue").click(function(){socket.emit("update cue","nothing")}),$("#saveCue").click(function(){socket.emit("save cue",{name:$("#cueName").val(),description:$("#cueDescription").val(),time:$("#cueTime").val(),follow:$("#cueFollow").val()})}),$("#cues").on("click","div.cue-item",function(){socket.emit("cue info",{cue_id:$(this).attr("cueVal")})}),$("#Submasters").on("click","button.sub-btn",function(){socket.emit("sub info",{sub:this.id})}),$("#Submasters").on("click","button#addSubBtn",function(){socket.emit("add sub","nothing")}),$("#deleteSubBtn").click(function(){t.style.display="none",socket.emit("remove sub","nothing")}),$("#sub-channels").on("click","button.sub-chan-save",function(){socket.emit("edit sub chan",{action:"save",chan:parseInt(this.getAttribute("subChan")),channel:$("#sub-channel-"+parseInt(this.getAttribute("subChan"))+"-channel").val(),value:$("#sub-channel-"+parseInt(this.getAttribute("subChan"))+"-value").val()})}),$("#sub-channels").on("click","button.sub-chan-delete",function(){socket.emit("edit sub chan",{action:"delete",chan:parseInt(this.getAttribute("subChan"))})}),$("#users").on("click","button.user-delete",function(){socket.emit("edit users",{action:"delete",user:parseInt(this.getAttribute("user"))})}),$("#addUserBtn").click(function(){socket.emit("edit users",{action:"new",user:prompt("Please enter the new username"),password:prompt("Please enter the new password")})}),$("#commandSubmitBtn").click(function(){return socket.emit("command message",{command:$("#commandInput").val()}),$("#commandInput").val(""),!1}),$("#commandReleaseBtn").click(function(){return socket.emit("command message",{command:"c rs"}),!1}),$("#recordCueBtn").click(function(){return socket.emit("command message",{command:"r q"}),!1}),$("#cueUpBtn").click(function(){socket.emit("cue move",{action:"up"})}),$("#cueDownBtn").click(function(){socket.emit("cue move",{action:"down"})}),$("#deleteCue").click(function(){socket.emit("cue move",{action:"delete"})}),$("#goCue").click(function(){socket.emit("command message",{command:"q 9949"})}),$("#nextCue").click(function(){socket.emit("cue move",{action:"next"})}),$("#releaseCues").click(function(){socket.emit("cue move",{action:"release"})}),$("#lastCue").click(function(){socket.emit("cue move",{action:"last"})}),$("#saveShowBtn").click(function(){socket.emit("save show",{name:$("#showName").val(),description:$("#showDescription").val(),author:$("#showAuthor").val(),copyright:$("#showCopyright").val()})}),$("#saveSubSettingsBtn").click(function(){socket.emit("save sub",{name:$("#subName").val(),value:$("#subValue").val()})}),$("#addSubChanBtn").click(function(){socket.emit("add sub chan","nothing")}),$("#clearShowBtn").click(function(){confirm("Are you sure you want clear everything?")&&($("#showName").val(""),$("#showDescription").val(""),$("#showAuthor").val(""),$("#showCopyright").val(""),socket.emit("clear show","none"))}),$("#commandClearBtn").click(function(){return $("#commandInput").val(""),!1}),$("#usersBtn").click(function(){return s.style.display="block",!1}),$(".saveSettingsBtn").click(function(){alert("The server must be restarted for IP changes to take effect."),socket.emit("save settings",{serverIP:$("#serverIP").val(),serverPort:$("#serverPort").val(),sacnIP:$("#sacnIP").val()})}),$("#resetSettingsBtn").click(function(){$("#serverIP").val("127.0.0.1"),$("#serverPort").val("9898"),$("#sacnIP").val("127.0.0.1")})});